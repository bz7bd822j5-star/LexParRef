<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LexParRef - RÃ©fÃ©rence Juridique</title>
  
  <!-- PWA Configuration -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0D2E4E">
  
  <!-- iOS PWA Icons -->
  <link rel="apple-touch-icon" href="police-logo.jpg">
  <link rel="apple-touch-icon" sizes="180x180" href="police-logo.jpg">
  <link rel="apple-touch-icon" sizes="152x152" href="police-logo.jpg">
  <link rel="apple-touch-icon" sizes="120x120" href="police-logo.jpg">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="LexParRef">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="admin-styles.css">
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="header-content">
      <div class="logo-section">
        <img src="police-logo.jpg" alt="Police Municipale DT Centre" class="header-logo">
        <div class="lexbar">
          <h1 class="lexbar-title">LexParRef</h1>
		          <p class="subtitle">RÃ©fÃ©rence Juridique â€“ ProcÃ©dures â€“ Documents</p>
        </div>
      </div>
      <div class="header-actions">
        
      </div>
    </div>
  </header>

  <!-- MODAL CONNEXION ADMIN -->
  <div id="adminLoginModal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>ğŸ” Connexion Administrateur</h3>
        <button onclick="closeAdminLogin()" class="close-btn">âœ•</button>
      </div>
      <div class="modal-body">
        <input type="password" id="adminPassword" placeholder="Mot de passe" class="admin-input">
        <button onclick="checkAdminPassword()" class="admin-login-btn">Se connecter</button>
        <p class="admin-hint">ğŸ’¡ Mot de passe par dÃ©faut : <code>admin123</code></p>
      </div>
    </div>
  </div>

  <!-- PANEL ADMIN -->
  <div id="adminPanel" class="admin-panel" style="display: none;">
    <div class="admin-header">
      <h2>ğŸ‘¨â€ğŸ’¼ Mode Administrateur</h2>
      <button onclick="logoutAdmin()" class="logout-btn">ğŸšª Quitter</button>
    </div>
    
    <div class="admin-sections">
      <!-- Gestion ProcÃ©dures -->
      <div class="admin-section">
        <h3>ğŸ“„ Gestion des ProcÃ©dures Ã‰tat-Major</h3>
        <div class="procedure-form">
          <input type="text" id="procTitle" placeholder="Titre de la procÃ©dure" class="form-input">
          <input type="text" id="procKeywords" placeholder="Mots-clÃ©s (sÃ©parÃ©s par des espaces)" class="form-input">
          <input type="text" id="procFile" placeholder="Nom du fichier PDF" class="form-input">
          <input type="text" id="procDate" placeholder="Date (ex: DÃ©cembre 2025)" class="form-input">
          <button onclick="addProcedure()" class="add-btn">â• Ajouter ProcÃ©dure</button>
        </div>
        
        <div class="procedures-list" id="proceduresList">
          <!-- Liste des procÃ©dures -->
        </div>
      </div>

      <!-- Documentation -->
      <div class="admin-section">
        <h3>ğŸ“š Documentation Utilisateur</h3>
        <div class="doc-form">
          <input type="text" id="docTitle" placeholder="Titre de la documentation" class="form-input">
          <textarea id="docContent" placeholder="Contenu de la documentation" class="form-textarea" rows="4"></textarea>
          <button onclick="addDocumentation()" class="add-btn">â• Ajouter Documentation</button>
        </div>
        
        <div class="docs-list" id="docsList">
          <!-- Liste des documentations -->
        </div>
      </div>

      <!-- Statistiques -->
      <div class="admin-section">
        <h3>ğŸ“Š Statistiques</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="totalSearches">0</div>
            <div class="stat-label">Recherches totales</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="totalProcedures">1</div>
            <div class="stat-label">ProcÃ©dures</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">16 977</div>
            <div class="stat-label">Articles disponibles</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- BARRE DE RECHERCHE UNIFIÃ‰E -->
  <div class="search-box compact">
  <input
    type="text"
    id="unifiedSearchInput"
    placeholder="Rechercher NATINF, article, procÃ©dureâ€¦"
  >

  <!-- Bouton recherche (loupe) -->
  <button onclick="unifiedSearch()" class="icon-btn search-icon" title="Rechercher">
    ğŸ”
  </button>
  <button id="resetSearchBtn" class="icon-btn reset-btn" title="Effacer la recherche">
    âœ•
  </button>

  <!-- Favoris -->
  <button onclick="showFavorites()" class="icon-btn" id="favoritesBtn" title="Favoris">
    â­ <span id="favoritesCount">0</span>
  </button>

  <!-- Terrasses autour -->
  <button onclick="showNearbyTerrasses()" class="icon-btn" title="Terrasses autour">
    ğŸ“
  </button>
</div>
    <div class="search-hints">
      ğŸ’¡ <strong>Exemples :</strong> stationnement gÃªnant â€¢ 222-19 â€¢ L234-1 â€¢ Natinfs
    </div>

  <!-- STATISTIQUES / NAVIGATION RÃ‰SULTATS -->
  <div class="stats">
    <div class="stat-box" id="resultsNavBox" style="display: none;">
      <!-- Les boutons seront gÃ©nÃ©rÃ©s dynamiquement par JavaScript -->
    </div>
  </div>

  <!-- RÃ‰SULTATS DE RECHERCHE -->
  <div id="searchResults" class="results-container"></div>

  <!-- ===============================
     Terrasses Ã  proximitÃ© (UI)
     =============================== -->
<section id="terrasses-nearby" class="terrasses-panel" hidden>
  <h3>Terrasses Ã  proximitÃ©</h3>
  <div class="terrasses-list"></div>
</section>

  <!-- CONTENU LÃ‰GIFRANCE (masquÃ©, garde la recherche d'articles) -->
  <div id="legifrance-content" style="display: none;">
    
    <!-- Recherche d'article -->
    <div class="legifrance-search">
      <h3>ğŸ” Recherche juridique</h3>
      <div class="article-search-form">
        <input type="text" id="articleInput" placeholder="Ex: 222-19, homicide involontaire, garde Ã  vue...">
        <select id="codeSelect">
          <option value="">ğŸ” Tous les codes (recherche locale)</option>
          <option value="LEGITEXT000006070719">ğŸ“• Code pÃ©nal (CP)</option>
          <option value="LEGITEXT000006074228">ğŸš— Code de la route (CR)</option>
          <option value="LEGITEXT000006071154">ğŸ“— Code de procÃ©dure pÃ©nale (CPP)</option>
          <option value="CODE_VOIRIE">ğŸ›£ï¸ Code de la voirie routiÃ¨re</option>
          <option value="CODE_CGCT">ğŸ›ï¸ Code gÃ©nÃ©ral des collectivitÃ©s territoriales (CGCT)</option>
          <option value="CODE_CSI">ğŸ”’ Code de la sÃ©curitÃ© intÃ©rieure (CSI)</option>
        </select>
        <button onclick="searchArticle()" class="search-btn">ğŸ” Rechercher</button>
      </div>
      <div class="search-help">
        ğŸ’¡ <strong>Article :</strong> 78-6, 222-19, L234-1 â€¢ <strong>Mots-clÃ©s :</strong> garde Ã  vue, homicide, vol violence
      </div>
    </div>

    <!-- AccÃ¨s LÃ©gifrance -->
    <h3 class="section-title">ğŸŒ AccÃ¨s LÃ©gifrance (si besoin)</h3>
    <div class="links-grid">
      <a href="https://www.legifrance.gouv.fr/" target="_blank" class="link-card">
        <h3>ğŸ” LÃ©gifrance</h3>
        <p>Portail officiel - Recherche tous textes</p>
      </a>
      <a href="https://www.legifrance.gouv.fr/search/juri" target="_blank" class="link-card">
        <h3>âš–ï¸ Jurisprudence</h3>
        <p>Cour de cassation et cours d'appel</p>
      </a>
    </div>
  </div>



  <script src="terrasses.js"></script>
  <script src="script.js"></script>
  <!-- FOOTER -->
  <footer class="app-footer">
    <button onclick="openSourcesModal()" class="sources-btn">
      â„¹ï¸ Sources et crÃ©dits
    </button>
  </footer>

  <!-- MODAL SOURCES -->
  <div id="sourcesModal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog sources-modal">
      <div class="modal-header">
        <h3>ğŸ“š Sources et informations</h3>
        <button onclick="closeSourcesModal()" class="close-btn">âœ•</button>
      </div>
      <div class="modal-body" id="sourcesContent">
        <div class="loading">Chargement...</div>
      </div>
    </div>
  </div>

  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
  </script>
</body>
</html>
